# OS solution

## 프로세스
  * 실행되고 있는 프로그램
  * 실행파일 클릭 -> 운영체제로부터 실행을 위한 메모리 할당 받기 -> 메모리 공간으로 코드 올라감 -> 그 순간부터 프로그램은 프로세스로
  * 프로세스는 함수의 매개변수, 복귀 주소와 로컬 변수와 같은 임시 자료를 갖는 프로세스 스택과 전역 변수들을 수록하는 데이터 섹션을 포함한다. 또한 프로세스는 프로세스 실행 중에 동적으로 할당되는 메모리인 힙을 포함한다.
  * 운영체제가 프로그램을 메모리의 적당한 위치로 가져오면 그와 동시에 [PCB 프로세스 제어 블록](#pcb(process-control-block)) 라는 걸 만드는데, 이 PCB 안에 프로세스를 실행하기 위한 다양한 정보가 들어있음
  * fork() : 프로세스 복사
    + 기존의 프로세스는 부모 프로세스가 되고 fork 로 복사 된 새 프로세스는 자식 프로세스 ex.새 창 띄우기

#### 메모리 구조
  * 코드영역 
    - 실행할 코드 저장되는 영역 = 텍스트 영역, CPU가 코드 영역에 저장된 명령어를 하나씩 가져가서 처리
  * 데이터 영역 
    - 프로그램 전역(global) 변수와 정적(static) 변수가 저장되는 영역  
    - 프로그램의 시작과 함꼐 할당 되었다가 프로그램 종료 시 소멸
  * 스택 영역
   + 함수를 호출할 때 함수 내부의 지역변수, 리턴값 등을 저장하거나 함수를 호출한 caller 의 환경 정보를 저장, 프로세스의 메모리 공간을 관리하기 위한 알고리즘 중 하나, 함수 호출시 기록하고 종료하면 제거, 컴파일 타임에 크기가 결정되기 때문에 무한히 할당 할 수 없고 stack 영역 초과하면 stack overflow 에러 발생
  * 힙 영역
   + 동적 할당 할 경우 Heap 영역에 할당, 런타임에 크기가 결정됨, 프로그래머가 필요할 때 마다 사용하는 메모리 영역, 사용 후 반드시 해제 해야 하며 그렇지 않으면 memory leak이 발생, stack보다 할당할 수 있는 메모리 공간이 많다는 것이 장점이지만 포인터로 메모리 영역에 접근해야 하기 때문에 다른 자료구조에 비해 데이터를 읽고 쓰는게 느림
    - Heap 은 메모리 주소가 낮은 영역부터 채워지고 Stack 은 메모리 주소가 높은 영역부터 채워짐
<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FuPagf%2FbtqARYnzzNJ%2FGSNKnhJccn3yoa2bvWcHj0%2Fimg.png"/><br>

#### PCB(Process Control Block)
  * 운영체제가 프로세스를 제어하기 위해 정보를 저장 해 놓는 곳, 상태정보를 저장함
  * PCB는 프로세스 생성 시 만들어지며 Context Switching 에 필요
    + CPU를 차지하던 프로세스가 나가고 새로운 프로세스를 받아들이는 작업
    + Context Switching Overhead : Context Switching 하는 과정에서 발생한 시간과 메모리
    + Context switching 동안 CPU는 아무런 일도 할 수 없으므로 잦게 발생하면 효율이 떨어짐
    + CPU가 이전 프로세스 상태를 PCB에 보관하고, 또 다른 프로세스의 정보를 PCB에서 읽어 레지스터에 적재하는 과정
  * 프로세스들이 교체되고 수행 될 때 다시 다른 프로세스를 불러와야 하는데 이전 작업에 대한 내용을 기억하고 있어야 하고 이렇게 프로세스 단위로 정보를 저장해주는 Block 이 PCB
  * PCB에서 유지되는 정보
    + PID : 프로세스의 고유 번호
    + 상태: 준비, 대기, 실행 등 상태
    + 포인터: 다음 실행 될 프로세스 포인터 (Linked list way)
    + Register save area: 레지스터 관련 정보
    + Priority: 스케쥴링 및 프로세스 우선순위
    + 입출력상태정보: 프로세스에 할당 된 입출력 장치들과 열린 파일 목록
    + Account: CPU 사용시간, 실제 사용된 시간
    + 입출력 상태 정보

### 프로세스와 쓰레드의 차이
  * 프로세스의 실행 단위
  * 같은 프로세스에 속한 다른 스레드와 코드, 데이터 센션등의 운영체제 자원들을 공유
  * 프로세스는 실행되는 프로그램과 사용중인 파일, 데이터, 메모리 영역, 주소 등 주변 환경을 뜻하고 쓰레드는 프로세스 내부에서 프로세스 자원을 공유하거나 공유하지 않고 실행되는 작업의 단위
  * 하나의 프로세스를 다수의 실행 단위로 구분하여 자원을 공유하고 중복성을 최소화 하여 수행 능력을 높이는 것이 멀테스레딩이며, 
#### 멀티스레딩
  * 이러한 경우 스레드는 독립적인 작업을 수행 해야 하기 때문에 스레드마다 스택을 독립적으로 할당 해야 함. 스택은 호출할 함수와 돌아갈 주소들을 저장하는 메모리 영역이고, 스레드마다 독립적인 함수를 호출하기 위해서 독립 스택 할당
  * 서로 다른 스레드가 힙 영역을 공유하기 때문에 동기화 작업이 필요하다. 동기화를 통해서 작업 처리 순서를 컨트롤하고 공유 자원에 대한 접근을 컨트롤 해야 하며, 이로 인한 병목 현상이 발생할 수 있다



